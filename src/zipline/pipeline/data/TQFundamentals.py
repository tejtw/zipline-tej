# # -*- coding: utf-8 -*-
# """
# Created on Fri Apr 28 11:40:32 2023

# @author: 2020033001
# """
# # from zipline.pipeline import Pipeline, CustomFactor
from zipline.pipeline.data import Column, DataSet, DataSetFamily
from zipline.pipeline.domain import Domain,TW_EQUITIES
import os 
from typing import Literal
import json
# current directory
# module_dir = os.path.dirname(os.path.abspath(__file__))
# json_path = os.path.join(module_dir,'TQDataSet.json')

# Read JSON file
# with open(json_path, 'r') as json_file:
#     data = json.load(json_file)
#     json_file.close()

class TQData(DataSetFamily):
    # 20231208 新增fin_order
    fin_order = Column(float)
    lag_fin_date = Column('datetime64[ns]')

    # TQDataSet
    domain = TW_EQUITIES
    symbol = Column(object)
    date = Column('datetime64[ns]')
    # Dividend_Yield_TWSE = Column(float)
    # Cash_Dividend_Yield_TEJ = Column(float)
    # Adjust_Factor = Column(float)
    # Transaction = Column(float)
    # # Common_Stock_Shares_Issued_Thousand_Shares = Column(float)
    # Issue_Shares_1000_Shares = Column(float)
    # PBR_TEJ = Column(float)
    # Low = Column(float)
    # PER_TWSE = Column(float)
    # Adjust_Factor_Exclude_CashDiv = Column(float)
    # Close = Column(float)
    # Market_Cap_Percentage = Column(float)
    # Open = Column(float)
    # PBR_TWSE = Column(float)
    # Last_Bid = Column(float)
    # Value_Dollars = Column(float)
    # High_Low_Diff = Column(float)
    # Average_Trade_Price = Column(float)
    # Trade_Value_Percentage = Column(float)
    # High = Column(float)
    # # Listing_Type = Column(object)
    # ROI = Column(float)
    # Turnover = Column(float)
    # PER_TEJ = Column(float)
    # Last_Offer = Column(float)
    # PSR_TEJ = Column(float)
    # Market_Cap_Dollars = Column(float)
    # Volume_1000_Shares = Column(float)
    # Component_Stock_of_High_Dividend_Fg = Column(object)
    # Matching_Period = Column(float)
    # Industry = Column(object)
    # Industry_Eng = Column(object)
    # Sub_Industry = Column(object)  # 20231108
    # Sub_Industry_Eng = Column(object) # 20231108
    # Security_Type_English = Column(object)
    # Component_Stock_of_MSCI_TW_Fg = Column(object)
    # Suspended_Trading_Stock_Fg = Column(object)
    # Attention_Stock_Fg = Column(object)
    # Component_Stock_of_MidCap100_Fg = Column(object)
    # Limit_Up_or_Down_in_Opening_Fg = Column(object)
    # Market_Board = Column(object)
    # Market_Board_Eng = Column(object)
    # Security_Type_Chinese = Column(object)
    # Suspension_of_Buy_After_Day_Trading_Fg = Column(object)
    # Limit_Up_or_Down = Column(object)
    # Component_Stock_of_TPEx200_Fg = Column(object)
    # Disposition_Stock_Fg = Column(object)
    # Full_Delivery_Stock_Fg = Column(object)
    # Component_Stock_of_TPEx50_Fg = Column(object)
    # Component_Stock_of_TWN50_Fg = Column(object)
    # Dealer_Hedge_Diff_Amt = Column(float)
    # Total_Sell_Amt = Column(float)
    # Margin_Day_Trading_Amt = Column(float)
    # Total_Buy_Vol = Column(float)
    # Fund_Sell_Vol = Column(float)
    # Fund_Stock_Holding_Pct = Column(float)
    # Dealer_Proprietary_Diff_Vol = Column(float)
    # Dealer_Proprietary_Sell_Vol = Column(float)
    # Margin_Short_Balance_Vol = Column(float)
    # Margin_Short_Maintenance_Ratio = Column(float)
    # SBL_Short_Returns_Vol = Column(float)
    # Fund_Buy_Vol = Column(float)
    # SBL_Short_Balance_Amt = Column(float)
    # Fund_Diff_Amt = Column(float)
    # SBL_Short_Sales_Vol = Column(float)
    # Qfii_Stock_Holding_Pct = Column(float)
    # Fund_Diff_Vol = Column(float)
    # Cash_Redemption = Column(float)
    # Dealer_Hedge_Diff_Vol = Column(float)
    # Dealer_Stock_Holding_Pct = Column(float)
    # SBL_Short_Balance_Vol = Column(float)
    # Fund_Sell_Amt = Column(float)
    # Margin_Purchase = Column(float)
    # Qfii_Diff_Vol = Column(float)
    # Total_Buy_Amt = Column(float)
    # Margin_Short_Balance_Amt = Column(float)
    # Margin_Short_Sales = Column(float)
    # Margin_Short_Quota = Column(float)
    # SBL_Short_Quota = Column(float)
    # Fund_Buy_Amt = Column(float)
    # Margin_Day_Trading_Vol = Column(float)
    # Total_Diff_Amt = Column(float)
    # Total_Sell_Vol = Column(float)
    # Dealer_Hedge_Buy_Vol = Column(float)
    # Qfii_Sell_Amt = Column(float)
    # Dealer_Hedge_Sell_Amt = Column(float)
    # SBL_Short_Sales_Amt = Column(float)
    # Dealer_Proprietary_Diff_Amt = Column(float)
    # Margin_Maintenance_Ratio = Column(float)
    # Qfii_Buy_Vol = Column(float)
    # Dealer_Proprietary_Sell_Amt = Column(float)
    # Dealer_Hedge_Buy_Amt = Column(float)
    # Margin_Short_Coverting = Column(float)
    # Day_Trading_Volume_1000_Shares = Column(float)
    # Dealer_Proprietary_Buy_Amt = Column(float)
    # Margin_Balance_Amt = Column(float)
    # Qfii_Buy_Amt = Column(float)
    # Qfii_Sell_Vol = Column(float)
    # Margin_Stock_Redemtion = Column(float)
    # Qfii_Diff_Amt = Column(float)
    # Account_Maintenance_Ratio = Column(float)
    # Margin_Quota = Column(float)
    # Margin_Balance_Vol = Column(float)
    # Margin_Balance_Ratio = Column(float)
    # Total_Diff_Vol = Column(float)
    # Day_Trading_Pct = Column(float)
    # Margin_Sale = Column(float)
    # Dealer_Proprietary_Buy_Vol = Column(float)
    # Dealer_Hedge_Sell_Vol = Column(float)
    # Custodied_Lots_Between_400_600_Pct = Column(float)
    # Custodied_Larger_Than_400_Lots_Total_Lots = Column(float)
    # Custodied_Greater_Than_1000_Lots_Total_Lots = Column(float)
    # Custodied_Lots_Between_800_1000_Total_Holders = Column(float)
    # Custodied_Lots_Between_600_800_Total_Holders = Column(float)
    # Pledged_Stock_Shares_1000_Lots = Column(float)
    # Custodied_Greater_Than_1000_Lots_Pct = Column(float)
    # Custodied_Lots_Between_600_800_Pct = Column(float)
    # Custodied_Lots_Between_800_1000_Total_Lots = Column(float)
    # Total_Custodied_Shares_1000_Lots = Column(float)
    # Custodied_Larger_Than_400_Lots_Total_Holders = Column(float)
    # Custodied_Larger_Than_400_Lots_Pct = Column(float)
    # Custodied_Under_400_Lots_Pct = Column(float)
    # Custodied_Greater_Than_1000_Lots_Total_Holders = Column(float)
    # Custodied_Under_400_Lots_Total_Holders = Column(float)
    # Custodied_Lots_Between_800_1000_Pct = Column(float)
    # Custodied_Lots_Between_600_800_Total_Lots = Column(float)
    # Custodied_Under_400_Lots_Total_Lots = Column(float)
    # Custodied_Lots_Between_400_600_Total_Lots = Column(float)
    # Custodied_Lots_Between_400_600_Total_Holders = Column(float)
    # Sales_Accu_LastYear = Column(float)
    # Outstanding_Shares_1000_Shares = Column(float)
    # MoM_Monthly_Sales = Column(float)
    # Sales_Per_Share_Accu = Column(float)
    # Month_Sales_Compared_To_Lowest_Month_Sales_MoM = Column(float)
    # YoY_Accu_Sales_3M = Column(float)
    # Lowest_Monthly_Sales_YM = Column('datetime64[ns]')
    # YoY_AccuSales_12M = Column(float)
    # Sales_Monthly = Column(float)
    # MoM_Accu_Sales_3M = Column(float)
    # Sales_Per_Share_Single_Month = Column(float)
    # Highest_Or_Lowest_In_12M = Column(object)
    # Hit_New_High_Or_Low_In_N_Months = Column(float)
    # Sales_Per_Share_Accu_3M = Column(float)
    # Sales_Accu_3M = Column(float)
    # Highest_Or_Lowest_Same_Month = Column(object)
    # Highest_Monthly_Sales_YM = Column('datetime64[ns]')
    # Month_Sales_Compared_To_High_Month_Sales_MoM = Column(float)
    # Lowest_Monthly_Sales = Column(float)
    # Highest_Monthly_Sales = Column(float)
    # Sales_Accu_3M_LastYear = Column(float)
    # Sales_Accumulated = Column(float)
    # YoY_Accu_Sales = Column(float)
    # Sales_Accu_12M_Last_Year = Column(float)
    # Sales_Accu_12M = Column(float)
    # Sales_Per_Share_Accu_12M = Column(float)
    # Highest_Or_Lowest_All_Time = Column(object)
    # YoY_Monthly_Sales = Column(float)
    # QoQ_Accu_Sales_3M = Column(float)
    # Sales_Monthly_LastYear = Column(float)
    Operating_Income_Rate_percent_A = Column(float)
    Operating_Income_Rate_percent_Q = Column(float)
    Operating_Income_Rate_percent_TTM = Column(float)
    Gross_Margin_Growth_Rate_A = Column(float)
    Gross_Margin_Growth_Rate_Q = Column(float)
    Gross_Margin_Growth_Rate_TTM = Column(float)
    Net_Income_Loss_A = Column(float)
    Net_Income_Loss_Q = Column(float)
    Net_Income_Loss_TTM = Column(float)
    Pre_Tax_Income_Growth_Rate_A = Column(float)
    Pre_Tax_Income_Growth_Rate_Q = Column(float)
    Pre_Tax_Income_Growth_Rate_TTM = Column(float)
    Net_Operating_Income_Loss_A = Column(float)
    Net_Operating_Income_Loss_Q = Column(float)
    Net_Operating_Income_Loss_TTM = Column(float)
    Profit_Before_Tax_A = Column(float)
    Profit_Before_Tax_Q = Column(float)
    Profit_Before_Tax_TTM = Column(float)
    Net_Income_Rate_percent_A = Column(float)
    Net_Income_Rate_percent_Q = Column(float)
    Net_Income_Rate_percent_TTM = Column(float)
    Net_Income_Attributable_to_Parent_A = Column(float)
    Net_Income_Attributable_to_Parent_Q = Column(float)
    Net_Income_Attributable_to_Parent_TTM = Column(float)
    Operating_Income_Growth_Rate_A = Column(float)
    Operating_Income_Growth_Rate_Q = Column(float)
    Operating_Income_Growth_Rate_TTM = Column(float)
    Gross_Profit_Loss_from_Operations_A = Column(float)
    Gross_Profit_Loss_from_Operations_Q = Column(float)
    Gross_Profit_Loss_from_Operations_TTM = Column(float)
    Total_Operating_Income_A = Column(float)
    Total_Operating_Income_Q = Column(float)
    Total_Operating_Income_TTM = Column(float)
    Pre_Tax_Income_Rate_percent_A = Column(float)
    Pre_Tax_Income_Rate_percent_Q = Column(float)
    Pre_Tax_Income_Rate_percent_TTM = Column(float)
    Net_Income_Per_Share_A = Column(float)
    Net_Income_Per_Share_Q = Column(float)
    Net_Income_Per_Share_TTM = Column(float)
    Pre_Tax_Income_Per_Share_A = Column(float)
    Pre_Tax_Income_Per_Share_Q = Column(float)
    Pre_Tax_Income_Per_Share_TTM = Column(float)
    Basic_Earnings_Per_Share_A = Column(float)
    Basic_Earnings_Per_Share_Q = Column(float)
    Basic_Earnings_Per_Share_TTM = Column(float)
    Net_Income_Growth_Rate_A = Column(float)
    Net_Income_Growth_Rate_Q = Column(float)
    Net_Income_Growth_Rate_TTM = Column(float)
    Sales_Growth_Rate_A = Column(float)
    Sales_Growth_Rate_Q = Column(float)
    Sales_Growth_Rate_TTM = Column(float)
    Gross_Margin_Rate_percent_A = Column(float)
    Gross_Margin_Rate_percent_Q = Column(float)
    Gross_Margin_Rate_percent_TTM = Column(float)
    Total_Equity_A = Column(float)
    Total_Equity_Q = Column(float)
    Total_Equity_TTM = Column(float)
    Total_Non_Current_Assets_A = Column(float)
    Total_Non_Current_Assets_Q = Column(float)
    Total_Non_Current_Assets_TTM = Column(float)
    Advances_Receipts_Non_Current_A = Column(float)
    Advances_Receipts_Non_Current_Q = Column(float)
    Advances_Receipts_Non_Current_TTM = Column(float)
    Short_Term_Borrowings_Financial_Institutions_A = Column(float)
    Short_Term_Borrowings_Financial_Institutions_Q = Column(float)
    Short_Term_Borrowings_Financial_Institutions_TTM = Column(float)
    Long_Term_Borrowings_Financial_Institutions_A = Column(float)
    Long_Term_Borrowings_Financial_Institutions_Q = Column(float)
    Long_Term_Borrowings_Financial_Institutions_TTM = Column(float)
    Total_Non_current_Liabilities_A = Column(float)
    Total_Non_current_Liabilities_Q = Column(float)
    Total_Non_current_Liabilities_TTM = Column(float)
    Depreciable_Fixed_Assets_Growth_Rate_A = Column(float)
    Depreciable_Fixed_Assets_Growth_Rate_Q = Column(float)
    Depreciable_Fixed_Assets_Growth_Rate_TTM = Column(float)
    Total_Assets_Turnover_A = Column(float)
    Total_Assets_Turnover_Q = Column(float)
    Total_Assets_Turnover_TTM = Column(float)
    Total_Assets_A = Column(float)
    Total_Assets_Q = Column(float)
    Total_Assets_TTM = Column(float)
    Return_Rate_on_Equity_A_percent_A = Column(float)
    Return_Rate_on_Equity_A_percent_Q = Column(float)
    Return_Rate_on_Equity_A_percent_TTM = Column(float)
    Cash_Flow_from_Operating_Ratio_A = Column(float)
    Cash_Flow_from_Operating_Ratio_Q = Column(float)
    Cash_Flow_from_Operating_Ratio_TTM = Column(float)
    Days_Payables_Outstanding_A = Column(float)
    Days_Payables_Outstanding_Q = Column(float)
    Days_Payables_Outstanding_TTM = Column(float)
    Total_Retained_Earnings_A = Column(float)
    Total_Retained_Earnings_Q = Column(float)
    Total_Retained_Earnings_TTM = Column(float)
    Capital_Reserves_A = Column(float)
    Capital_Reserves_Q = Column(float)
    Capital_Reserves_TTM = Column(float)
    Accounts_Payable_Turnover_A = Column(float)
    Accounts_Payable_Turnover_Q = Column(float)
    Accounts_Payable_Turnover_TTM = Column(float)
    Cash_Flow_from_Investing_Activities_A = Column(float)
    Cash_Flow_from_Investing_Activities_Q = Column(float)
    Cash_Flow_from_Investing_Activities_TTM = Column(float)
    Non_Operating_Income_A = Column(float)
    Non_Operating_Income_Q = Column(float)
    Non_Operating_Income_TTM = Column(float)
    Prepayments_A = Column(float)
    Prepayments_Q = Column(float)
    Prepayments_TTM = Column(float)
    Accounts_Payable_A = Column(float)
    Accounts_Payable_Q = Column(float)
    Accounts_Payable_TTM = Column(float)
    Inventory_Turnover_A = Column(float)
    Inventory_Turnover_Q = Column(float)
    Inventory_Turnover_TTM = Column(float)
    Net_Non_operating_Income_Ratio_A = Column(float)
    Net_Non_operating_Income_Ratio_Q = Column(float)
    Net_Non_operating_Income_Ratio_TTM = Column(float)
    Other_Receivables_A = Column(float)
    Other_Receivables_Q = Column(float)
    Other_Receivables_TTM = Column(float)
    Days_Receivables_Outstanding_A = Column(float)
    Days_Receivables_Outstanding_Q = Column(float)
    Days_Receivables_Outstanding_TTM = Column(float)
    Recurring_Net_Income_A = Column(float)
    Recurring_Net_Income_Q = Column(float)
    Recurring_Net_Income_TTM = Column(float)
    Intangible_Assets_A = Column(float)
    Intangible_Assets_Q = Column(float)
    Intangible_Assets_TTM = Column(float)
    Common_Stocks_A = Column(float)
    Common_Stocks_Q = Column(float)
    Common_Stocks_TTM = Column(float)
    # Common_Stock_Shares_Issued_Thousand_Shares_A = Column(float)
    # Common_Stock_Shares_Issued_Thousand_Shares_Q = Column(float)
    # Common_Stock_Shares_Issued_Thousand_Shares_TTM = Column(float)
    Short_Term_Borrowings_Non_Financial_Institutions_A = Column(float)
    Short_Term_Borrowings_Non_Financial_Institutions_Q = Column(float)
    Short_Term_Borrowings_Non_Financial_Institutions_TTM = Column(float)
    Liabilities_Ratio_A = Column(float)
    Liabilities_Ratio_Q = Column(float)
    Liabilities_Ratio_TTM = Column(float)
    Total_Current_Liabilities_A = Column(float)
    Total_Current_Liabilities_Q = Column(float)
    Total_Current_Liabilities_TTM = Column(float)
    Debt_Equity_Ratio_A = Column(float)
    Debt_Equity_Ratio_Q = Column(float)
    Debt_Equity_Ratio_TTM = Column(float)
    Current_Ratio_A = Column(float)
    Current_Ratio_Q = Column(float)
    Current_Ratio_TTM = Column(float)
    Interest_Expense_A = Column(float)
    Interest_Expense_Q = Column(float)
    Interest_Expense_TTM = Column(float)
    Inventories_A = Column(float)
    Inventories_Q = Column(float)
    Inventories_TTM = Column(float)
    Total_Liabilities_and_Equity_A = Column(float)
    Total_Liabilities_and_Equity_Q = Column(float)
    Total_Liabilities_and_Equity_TTM = Column(float)
    Sales_Per_Share_A = Column(float)
    Sales_Per_Share_Q = Column(float)
    Sales_Per_Share_TTM = Column(float)
    Non_Controlling_Interest_A = Column(float)
    Non_Controlling_Interest_Q = Column(float)
    Non_Controlling_Interest_TTM = Column(float)
    Long_Term_Accounts_Receivable_A = Column(float)
    Long_Term_Accounts_Receivable_Q = Column(float)
    Long_Term_Accounts_Receivable_TTM = Column(float)
    Number_of_Employees_A = Column(float)
    Number_of_Employees_Q = Column(float)
    Number_of_Employees_TTM = Column(float)
    Total_Equity_Growth_Rate_A = Column(float)
    Total_Equity_Growth_Rate_Q = Column(float)
    Total_Equity_Growth_Rate_TTM = Column(float)
    Total_Fixed_Assets_A = Column(float)
    Total_Fixed_Assets_Q = Column(float)
    Total_Fixed_Assets_TTM = Column(float)
    Quick_Assets_A = Column(float)
    Quick_Assets_Q = Column(float)
    Quick_Assets_TTM = Column(float)
    Fixed_Assets_A = Column(float)
    Fixed_Assets_Q = Column(float)
    Fixed_Assets_TTM = Column(float)
    Interest_Expense_Rate_percent_A = Column(float)
    Interest_Expense_Rate_percent_Q = Column(float)
    Interest_Expense_Rate_percent_TTM = Column(float)
    Total_Operating_Cost_A = Column(float)
    Total_Operating_Cost_Q = Column(float)
    Total_Operating_Cost_TTM = Column(float)
    Equity_Turnover_A = Column(float)
    Equity_Turnover_Q = Column(float)
    Equity_Turnover_TTM = Column(float)
    Taxrate_A = Column(float)
    Taxrate_Q = Column(float)
    Taxrate_TTM = Column(float)
    Other_Accounts_Payable_A = Column(float)
    Other_Accounts_Payable_Q = Column(float)
    Other_Accounts_Payable_TTM = Column(float)
    Accounts_Receivable_Current_and_Non_Current_A = Column(float)
    Accounts_Receivable_Current_and_Non_Current_Q = Column(float)
    Accounts_Receivable_Current_and_Non_Current_TTM = Column(float)
    Sales_Per_Employee_A = Column(float)
    Sales_Per_Employee_Q = Column(float)
    Sales_Per_Employee_TTM = Column(float)
    Total_Other_Equity_Interest_A = Column(float)
    Total_Other_Equity_Interest_Q = Column(float)
    Total_Other_Equity_Interest_TTM = Column(float)
    Non_Recurring_Net_Income_A = Column(float)
    Non_Recurring_Net_Income_Q = Column(float)
    Non_Recurring_Net_Income_TTM = Column(float)
    Operating_Expenses_Ratio_A = Column(float)
    Operating_Expenses_Ratio_Q = Column(float)
    Operating_Expenses_Ratio_TTM = Column(float)
    Income_Tax_Expense_A = Column(float)
    Income_Tax_Expense_Q = Column(float)
    Income_Tax_Expense_TTM = Column(float)
    Weighted_Average_Outstanding_Shares_Thousand_A = Column(float)
    Weighted_Average_Outstanding_Shares_Thousand_Q = Column(float)
    Weighted_Average_Outstanding_Shares_Thousand_TTM = Column(float)
    Preferred_Stock_Dividends_A = Column(float)
    Preferred_Stock_Dividends_Q = Column(float)
    Preferred_Stock_Dividends_TTM = Column(float)
    Times_Interest_Earned_A = Column(float)
    Times_Interest_Earned_Q = Column(float)
    Times_Interest_Earned_TTM = Column(float)
    Days_Inventory_Outstanding_A = Column(float)
    Days_Inventory_Outstanding_Q = Column(float)
    Days_Inventory_Outstanding_TTM = Column(float)
    Preferred_Stocks_A = Column(float)
    Preferred_Stocks_Q = Column(float)
    Preferred_Stocks_TTM = Column(float)
    Cash_Flow_from_Operating_Activities_A = Column(float)
    Cash_Flow_from_Operating_Activities_Q = Column(float)
    Cash_Flow_from_Operating_Activities_TTM = Column(float)
    Total_Current_Assets_A = Column(float)
    Total_Current_Assets_Q = Column(float)
    Total_Current_Assets_TTM = Column(float)
    Depreciation_and_Amortisation_A = Column(float)
    Depreciation_and_Amortisation_Q = Column(float)
    Depreciation_and_Amortisation_TTM = Column(float)
    Advances_Receipts_Current_A = Column(float)
    Advances_Receipts_Current_Q = Column(float)
    Advances_Receipts_Current_TTM = Column(float)
    Borrowings_A = Column(float)
    Borrowings_Q = Column(float)
    Borrowings_TTM = Column(float)
    Total_Liabilities_A = Column(float)
    Total_Liabilities_Q = Column(float)
    Total_Liabilities_TTM = Column(float)
    Total_Interest_Income_A = Column(float)
    Total_Interest_Income_Q = Column(float)
    Total_Interest_Income_TTM = Column(float)
    Accounts_Receivable_A = Column(float)
    Accounts_Receivable_Q = Column(float)
    Accounts_Receivable_TTM = Column(float)
    Accounts_Receivable_Turnover_A = Column(float)
    Accounts_Receivable_Turnover_Q = Column(float)
    Accounts_Receivable_Turnover_TTM = Column(float)
    Acid_Test_A = Column(float)
    Acid_Test_Q = Column(float)
    Acid_Test_TTM = Column(float)
    Total_Operating_Expenses_A = Column(float)
    Total_Operating_Expenses_Q = Column(float)
    Total_Operating_Expenses_TTM = Column(float)
    Cash_and_Cash_Equivalent_A = Column(float)
    Cash_and_Cash_Equivalent_Q = Column(float)
    Cash_and_Cash_Equivalent_TTM = Column(float)
    Operating_Income_Per_Share_A = Column(float)
    Operating_Income_Per_Share_Q = Column(float)
    Operating_Income_Per_Share_TTM = Column(float)
    Earnings_Before_Interest_and_Tax_A = Column(float)
    Earnings_Before_Interest_and_Tax_Q = Column(float)
    Earnings_Before_Interest_and_Tax_TTM = Column(float)
    Return_on_Total_Assets_A_percent_A = Column(float)
    Return_on_Total_Assets_A_percent_Q = Column(float)
    Return_on_Total_Assets_A_percent_TTM = Column(float)
    Fixed_Asset_Turnover_A = Column(float)
    Fixed_Asset_Turnover_Q = Column(float)
    Fixed_Asset_Turnover_TTM = Column(float)
    Long_Term_Borrowings_Non_Financial_Institutions_A = Column(float)
    Long_Term_Borrowings_Non_Financial_Institutions_Q = Column(float)
    Long_Term_Borrowings_Non_Financial_Institutions_TTM = Column(float)
    Cash_Flow_from_Financing_Activities_A = Column(float)
    Cash_Flow_from_Financing_Activities_Q = Column(float)
    Cash_Flow_from_Financing_Activities_TTM = Column(float)
    Book_Value_Per_Share_A_A = Column(float)
    Book_Value_Per_Share_A_Q = Column(float)
    Book_Value_Per_Share_A_TTM = Column(float)
    Total_Assets_Growth_Rate_A = Column(float)
    Total_Assets_Growth_Rate_Q = Column(float)
    Total_Assets_Growth_Rate_TTM = Column(float)
    # fin_date, mon_sales_date, share_date
    fin_date = Column('datetime64[ns]')
    # mon_sales_date = Column('datetime64[ns]')
    # share_date = Column('datetime64[ns]')

    Director_and_Supervisor_Holdings = Column(float)
    Net_Cash_Flows_From_Used_In_Operating_Activities_Q = Column(float)
    Difference_in_Top_10_Shareholder_Pledged_Shares_Excluding_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Difference_in_Directors_Relatives_Total_Pledged_Shares_Percentage_from_Previous_Period = Column(float)
    Specific_Rate_Percentage = Column(float)
    Net_Service_Fee_Charge_Income_Losses_Banking_And_Financial_Q = Column(float)
    Total_Stock_Capital_Thousand_TWD = Column(float)
    Discounts_And_Loans_Net_Banking_And_Financial_Q = Column(float)
    Net_Cash_Flows_From_Used_In_Financing_Activities_A = Column(float)
    Short_Term_And_Long_Term_Liabilities_Q = Column(float)
    Preference_Share_Dividends_Q = Column(float)
    Difference_in_Managers_Pledged_Shares_Percentage_Including_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Major_Shareholder_Total_Pledged_Shares_1 = Column(float)
    Dividend_Pay_Times = Column(float)
    Total_Director_and_Supervisor_Holdings = Column(float)
    Managers_Relatives_Total_Pledged_Shares_Including_Directors_and_Supervisors = Column(float)
    Directors_and_Supervisors_Pledged_Shares = Column(float)
    Total_Non_Operating_Income_And_Expenses_Securities_TTM = Column(float)
    Total_Asset_Turnover_Q = Column(float)
    Profit_Loss_Attributable_To_Owners_Of_Parent_A = Column(float)
    Total_Shares_Thousand_Shares = Column(float)
    Total_Liabilities_And_Equity_Q = Column(float)
    Total_Non_Operating_Income_And_Expenses_Securities_A = Column(float)
    Capital_Reserves_Rights_Issuance_Rate_Percentage = Column(float)
    Profit_Loss_Attributable_To_Owners_Of_Parent_TTM = Column(float)
    Other_Thousand_Shares = Column(float)
    Basic_Earnings_Per_Share_MOPS_A = Column(float)
    Profit_Loss_Before_Tax_A = Column(float)
    Total_Operating_Revenue_Q = Column(float)
    Total_Expenditure_And_Expense_Securities_Q = Column(float)
    Managers_Pledged_Shares = Column(float)
    Executive_Directors_Count = Column(float)
    Difference_in_Top_10_Shareholder_Total_Pledged_Shares_Percentage_Including_Rollover_from_Previous_Period = Column(float)
    Capital_Reduction_Rate_Percentage = Column(float)
    Difference_Major_Shareholder_Total_Pledged_Shares_1 = Column(float)
    Convertible_Bonds_Conversion_Price_Per_Unit = Column(float)
    Total_Treasury_Shares_TTM = Column(float)
    Total_Equity_Attributable_To_Owners_Of_Parent_A = Column(float)
    Gross_Profit_Loss_From_Operations_A = Column(float)
    Major_Shareholder_Total_Holdings_TSE = Column(float)
    Managers_Total_Holdings_Percentage_Including_Directors_and_Supervisors = Column(float)
    Top_10_Shareholder_Total_Pledge_Shares_Percentage_2 = Column(float)
    Difference_in_Top_10_Shareholder_Total_Holdings_Percentage_Excluding_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Difference_in_Major_Shareholder_Holdings_Percentage_TSE_from_Previous_Period = Column(float)
    Difference_in_Manager_Holdings_from_Previous_Period = Column(float)
    Difference_in_Managers_Relatives_Total_Pledged_Shares_from_Previous_Period = Column(float)
    Buyback_Number = Column(float)
    Total_CI_TTM = Column(float)
    Net_Cash_Flows_From_Used_In_Financing_Activities_TTM = Column(float)
    Foreign_Independent_Directors_Count = Column(float)
    General_Directors_Count = Column(float)
    Difference_in_Supervisor_Holdings_Percentage_from_Previous_Period = Column(float)
    Days_Sales_Outstanding_TTM = Column(float)
    Difference_in_Directors_and_Supervisors_Relatives_Total_Pledged_Shares_from_Previous_Period = Column(float)
    Total_Treasury_Shares_Q = Column(float)
    Debt_To_Equity_Ratio_A = Column(float)
    BV_Per_Share_A_Reserve_For_Capital_Increase_And_Preference_Shares_Adjusted_A = Column(float)
    Difference_in_Managers_Total_Holdings_Percentage_Including_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Total_Revenue_Securities_A = Column(float)
    Finance_Costs_Net_TTM = Column(float)
    Managers_Pledged_Shares_Percentage = Column(float)
    Days_Payable_Outstanding_Q = Column(float)
    Net_Cash_Flows_From_Used_In_Operating_Activities_A = Column(float)
    Total_Non_Operating_Income_And_Expenses_Q = Column(float)
    Difference_in_Managers_Relatives_Holdings_Percentage_from_Previous_Period = Column(float)
    Stock_Div_Earnings = Column(float)
    Net_Service_Fee_Charge_Income_Losses_Banking_And_Financial_A = Column(float)
    Cumulative_Holding_Percentage = Column(float)
    Managers_Relatives_Total_Pledged_Shares = Column(float)
    Net_Profit_Margin_Before_Interest_Taxes_Depreciation_And_Amortization_A = Column(float)
    Merger_Thousand_Shares = Column(float)
    Total_Non_Operating_Income_And_Expenses_Insurance_A = Column(float)
    Total_Operating_Revenue_A = Column(float)
    Earnings_Before_Interest_Tax_Depreciation_And_Amortization_A = Column(float)
    Difference_in_Managers_Pledged_Shares_Including_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Directors_and_Supervisors_Relatives_Pledged_Shares_Percentage = Column(float)
    Major_Shareholder_Relatives_Total_Holdings_1_Excluding_Directors_and_Supervisors = Column(float)
    ROA_A_Income_From_Continuing_Operation_Before_Interest_A = Column(float)
    Total_Non_Current_Liabilities_TTM = Column(float)
    Managers_Relatives_Pledged_Shares_Percentage = Column(float)
    Net_Income_Loss_Of_Interest_Banking_And_Financial__TTM = Column(float)
    Major_Shareholder_Total_Pledged_Shares_TSE = Column(float)
    Supervisors_Total_Pledged_Shares = Column(float)
    Directors_Pledged_Shares_Percentage = Column(float)
    Earnings_Before_Interest_And_Tax_Q = Column(float)
    Difference_in_Top_10_Shareholder_Holdings_Percentage_Excluding_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Outstanding_Shares_1000_Shares_Monthly_Frequency = Column(float)
    Total_Non_Operating_Income_And_Expenses_Insurance_Q = Column(float)
    Preferred_Stock_Shares_Q = Column(float)
    Difference_in_Manager_Holdings_Percentage_Including_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Top_10_Shareholder_Total_Holdings_Excluding_Directors_and_Supervisors = Column(float)
    Convertible_Bonds_Securities_Conversion_Thousand_Shares = Column(float)
    Days_Payable_Outstanding_A = Column(float)
    NCI_A = Column(float)
    Total_Assets_Growth_Rate_YOY_Q = Column(float)
    ROE_After_Tax_A = Column(float)
    Difference_in_Directors_and_Supervisors_Relatives_Holdings_Percentage_from_Previous_Period = Column(float)
    Difference_in_Supervisors_Total_Pledged_Shares_Percentage_from_Previous_Period = Column(float)
    Directors_Relatives_Total_Pledged_Shares_Percentage = Column(float)
    Difference_in_Directors_and_Supervisors_Relatives_Pledged_Shares_Percentage_from_Previous_Period = Column(float)
    Profit_Loss_Before_Tax_TTM = Column(float)
    Transfer_Thousand_Shares = Column(float)
    Directors_and_Supervisors_Relatives_Holdings_Percentage = Column(float)
    Total_Expenditure_And_Expense_Securities_TTM = Column(float)
    Net_Profit_Margin_Before_Interest_Taxes_Depreciation_And_Amortization_Q = Column(float)
    Total_Non_Operating_Income_And_Expenses_Securities_Q = Column(float)
    Net_Income_Banking_And_Financial_Q = Column(float)
    Foreign_Independent_Supervisors_Count = Column(float)
    Total_Liabilities_And_Equity_TTM = Column(float)
    Total_Equity_Attributable_To_Owners_Of_Parent_Q = Column(float)
    Par_Value = Column(float)
    Managers_Total_Shares_Including_Directors_and_Supervisors = Column(float)
    Total_Buyback_Price = Column(float)
    Preference_Share_Dividends_A = Column(float)
    Director_Holdings = Column(float)
    Total_Interest_Expenses_Banking_And_Financial__A = Column(float)
    Debt_To_Equity_Ratio_TTM = Column(float)
    Short_Term_And_Long_Term_Liabilities_TTM = Column(float)
    Debt_To_Equity_Ratio_Q = Column(float)
    Managers_Pledged_Shares_Including_Directors_and_Supervisors = Column(float)
    Total_Interest_Expenses_Banking_And_Financial__Q = Column(float)
    Managers_Total_Pledged_Shares = Column(float)
    Stock_Div_Capital = Column(float)
    Difference_in_Total_Director_Holdings_from_Previous_Period = Column(float)
    R_and_D_Expenses_Ratio_Q = Column(float)
    Total_Assets_Growth_Rate_YOY_TTM = Column(float)
    Supervisors_Relatives_Holdings_Percentage = Column(float)
    Difference_in_Managers_Relatives_Total_Pledged_Shares_Including_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Profit_Loss_Attributable_To_Owners_Of_Parent_Q = Column(float)
    Total_Operating_Costs_A = Column(float)
    Adjust_Factor_Exclude_CashDiv = Column(float)
    Difference_Top_10_Shareholder_Total_Pledge_Shares_Percentage_2 = Column(float)
    Payout_Ratio = Column(float)
    Difference_in_Managers_Total_Pledged_Shares_Percentage_Including_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Total_Operating_Costs_Q = Column(float)
    Total_Asset_Turnover_TTM = Column(float)
    Profit_Loss_From_Continuing_Operations_A = Column(float)
    Difference_in_Manager_Holdings_Percentage_from_Previous_Period = Column(float)
    Difference_in_Supervisors_Total_Pledged_Shares_from_Previous_Period = Column(float)
    Difference_in_Directors_and_Supervisors_Total_Pledged_Shares_Percentage_from_Previous_Period = Column(float)
    Difference_in_Major_Shareholder_Total_Pledged_Shares_Percentage_TSE_from_Previous_Period = Column(float)
    Difference_in_Supervisors_Relatives_Total_Holdings_from_Previous_Period = Column(float)
    Basic_Earnings_Per_Share_MOPS_Q = Column(float)
    Cash_Back_Per_Share_After_Reduction = Column(float)
    Difference_in_Total_Supervisor_Holdings_from_Previous_Period = Column(float)
    Major_Shareholder_Relatives_Holdings_Percentage_1_Excluding_Directors_and_Supervisors = Column(float)
    Difference_in_Major_Shareholder_Total_Holdings_TSE_from_Previous_Period = Column(float)
    Supervisors_Relatives_Total_Holdings = Column(float)
    Total_Expenditure_And_Expense_Securities_A = Column(float)
    Top_10_Shareholder_Relatives_Total_Holdings_2_Excluding_Directors_and_Supervisors = Column(float)
    Weighted_Average_Number_Of_Ordinary_Shares_In_Thousands_Q = Column(float)
    Short_Term_And_Long_Term_Liabilities_A = Column(float)
    Difference_in_Supervisors_Relatives_Pledged_Shares_Percentage_from_Previous_Period = Column(float)
    Issue_Shares_1000_Shares = Column(float)
    Supervisors_Relatives_Total_Pledged_Shares = Column(float)
    Difference_in_Directors_and_Supervisors_Total_Pledged_Shares_from_Previous_Period = Column(float)
    Directors_Relatives_Total_Pledged_Shares = Column(float)
    Difference_in_Managers_Relatives_Pledged_Shares_Percentage_Including_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Managers_Relatives_Total_Holdings_Including_Directors_and_Supervisors = Column(float)
    Managers_Relatives_Holdings_Percentage_Including_Directors_and_Supervisors = Column(float)
    Difference_in_Supervisors_Relatives_Total_Pledged_Shares_from_Previous_Period = Column(float)
    Employee_Stock_Options_Thousand_Shares = Column(float)
    Discounts_And_Loans_Net_Banking_And_Financial_A = Column(float)
    Difference_in_Major_Shareholder_Pledged_Shares_Percentage_TSE_from_Previous_Period = Column(float)
    NCI_Q = Column(float)
    Difference_in_Managers_Total_Shares_Including_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Earnings_Capital_Increase_Thousand_Shares = Column(float)
    Preference_Share_Dividends_TTM = Column(float)
    Difference_in_Manager_Holdings_Including_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Major_Shareholder_Holdings_TSE = Column(float)
    Earnings_Before_Interest_Tax_Depreciation_And_Amortization_TTM = Column(float)
    Difference_in_Managers_Total_Pledged_Shares_from_Previous_Period = Column(float)
    Gross_Profit_Loss_From_Operations_TTM = Column(float)
    Difference_in_Major_Shareholder_Relatives_Holdings_Percentage_1_Excluding_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Manager_Holdings_Including_Directors_and_Supervisors = Column(float)
    Supervisors_Total_Holdings_Percentage = Column(float)
    Total_Asset_Turnover_A = Column(float)
    Difference_in_Directors_Pledged_Shares_from_Previous_Period = Column(float)
    Cash_Subscription_Rate_Percentage = Column(float)
    Difference_in_Total_Director_and_Supervisor_Holdings_Percentage_from_Previous_Period = Column(float)
    Difference_in_Director_and_Supervisor_Holdings_Percentage_from_Previous_Period = Column(float)
    Top_10_Shareholder_Holdings_Percentage_Excluding_Directors_and_Supervisors = Column(float)
    Average_Buyback_Price = Column(float)
    Days_Sales_Outstanding_A = Column(float)
    Directors_and_Supervisors_Relatives_Total_Pledged_Shares = Column(float)
    Total_Interest_Expenses_Banking_And_Financial__TTM = Column(float)
    Treasury_Stock_Cancellation_Thousand_Shares = Column(float)
    Foreign_Directors_Count = Column(float)
    Difference_in_Managers_Pledged_Shares_from_Previous_Period = Column(float)
    Directors_Total_Pledged_Shares_Percentage = Column(float)
    Subtotal_Stock_Div = Column(float)
    Difference_in_Directors_Total_Pledged_Shares_Percentage_from_Previous_Period = Column(float)
    Profit_Loss_From_Continuing_Operations_Q = Column(float)
    Directors_and_Supervisors_Pledged_Shares_Percentage = Column(float)
    Finance_Costs_Net_Q = Column(float)
    Total_Operating_Costs_Insurance_A = Column(float)
    ROE_After_Tax_TTM = Column(float)
    Restricted_Employee_Rights_New_Stock_Thousand_Shares = Column(float)
    Difference_in_Major_Shareholder_Total_Pledged_Shares_TSE_from_Previous_Period = Column(float)
    Difference_Major_Shareholder_Total_Pledge_Shares_Percentage_1 = Column(float)
    Top_10_Shareholder_Pledged_Shares_Excluding_Directors_and_Supervisors = Column(float)
    Independent_Directors_Count = Column(float)
    Difference_in_Supervisors_Pledged_Shares_from_Previous_Period = Column(float)
    R_and_D_Expenses_Ratio_A = Column(float)
    Net_Income_Banking_And_Financial_A = Column(float)
    Major_Shareholder_Pledged_Shares_Percentage_TSE = Column(float)
    Equivalent_Shares_Of_Stock_Dividend_To_Be_Distributed_TTM = Column(float)
    Buyback_Price_Range_Upper_Limit = Column(float)
    Total_Operating_Costs_Insurance_TTM = Column(float)
    Supervisors_Pledged_Shares = Column(float)
    Days_Inventory_On_Hand_A = Column(float)
    Directors_Total_Pledged_Shares = Column(float)
    Acid_Test_Ratio_TTM = Column(float)
    Weighted_Average_Number_Of_Ordinary_Shares_In_Thousands_TTM = Column(float)
    Total_Supervisors_Count = Column(float)
    Net_Cash_Flows_From_Used_In_Financing_Activities_Q = Column(float)
    Total_Operating_Costs_Insurance_Q = Column(float)
    Previous_Day_Closing_Price_Per_Unit = Column(float)
    Difference_in_Managers_Pledged_Shares_Percentage_from_Previous_Period = Column(float)
    Difference_in_Director_Holdings_from_Previous_Period = Column(float)
    Total_Directors_Count = Column(float)
    Difference_in_Top_10_Shareholder_Relatives_Total_Holdings_2_Excluding_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Capital_Reduction_Thousand_Shares = Column(float)
    Total_Non_Operating_Income_And_Expenses_A = Column(float)
    Employee_Rights_Issuance_Rate_Percentage = Column(float)
    Directors_and_Supervisors_Relatives_Total_Holdings = Column(float)
    Net_Profit_Margin_Before_Interest_Taxes_Depreciation_And_Amortization_TTM = Column(float)
    Supervisor_Holdings = Column(float)
    Cumulative_Holding_Shares = Column(float)
    ROE_After_Tax_Q = Column(float)
    Days_Inventory_On_Hand_TTM = Column(float)
    Convertible_Shares_Thousand_Shares = Column(float)
    Difference_in_Director_and_Supervisor_Holdings_from_Previous_Period = Column(float)
    Difference_in_Supervisors_Pledged_Shares_Percentage_from_Previous_Period = Column(float)
    Net_Cash_Flows_From_Used_In_Investing_Activities_Q = Column(float)
    Common_Stock_Shares_TTM = Column(float)
    Difference_in_Top_10_Shareholder_Pledged_Shares_Percentage_Excluding_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Equivalent_Shares_Of_Stock_Dividend_To_Be_Distributed_Q = Column(float)
    Total_Revenue_Securities_TTM = Column(float)
    Managers_Relatives_Total_Holdings = Column(float)
    Acid_Test_Ratio_A = Column(float)
    Managers_Total_Shares = Column(float)
    Discounts_And_Loans_Net_Banking_And_Financial_TTM = Column(float)
    Net_Cash_Flows_From_Used_In_Investing_Activities_TTM = Column(float)
    Total_Assets_Growth_Rate_YOY_A = Column(float)
    Cash_Subscription_Price_Per_Unit = Column(float)
    Directors_Relatives_Total_Holdings = Column(float)
    Total_Deposits_And_Remittances_Banking_And_Financial_TTM = Column(float)
    Total_Deposits_And_Remittances_Banking_And_Financial_Q = Column(float)
    ROA_A_Income_From_Continuing_Operation_Before_Interest_TTM = Column(float)
    Difference_in_Directors_Pledged_Shares_Percentage_from_Previous_Period = Column(float)
    Total_Supervisor_Holdings = Column(float)
    Cash_Flow_Ratio_Q = Column(float)
    Net_Income_Banking_And_Financial_TTM = Column(float)
    Insufficient_Director_Shares = Column(float)
    Chairman_Count = Column(float)
    Difference_in_Total_Director_and_Supervisor_Holdings_from_Previous_Period = Column(float)
    Executive_Supervisors_Count = Column(float)
    Directors_Relatives_Holdings_Percentage = Column(float)
    Managers_Relatives_Pledged_Shares_Percentage_Including_Directors_and_Supervisors = Column(float)
    Difference_Top_10_Shareholder_Total_Pledge_Shares_2 = Column(float)
    Total_Deposits_And_Remittances_Banking_And_Financial_A = Column(float)
    Difference_in_Managers_Total_Shares_from_Previous_Period = Column(float)
    Capital_Reserves_Capital_Increase_Thousand_Shares = Column(float)
    Managers_Total_Pledged_Shares_Including_Directors_and_Supervisors = Column(float)
    Profit_Loss_Before_Tax_Q = Column(float)
    Total_Equity_Attributable_To_Owners_Of_Parent_TTM = Column(float)
    BV_Per_Share_A_Reserve_For_Capital_Increase_And_Preference_Shares_Adjusted_Q = Column(float)
    Difference_in_Managers_Relatives_Holdings_Percentage_Including_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Profit_Loss_From_Continuing_Operations_TTM = Column(float)
    Difference_in_Managers_Total_Pledged_Shares_Including_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Difference_in_Managers_Relatives_Total_Holdings_Including_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Earnings_Rights_Issuance_Rate_Percentage = Column(float)
    Difference_in_Major_Shareholder_Total_Holdings_Percentage_TSE_from_Previous_Period = Column(float)
    Directors_and_Supervisors_Total_Pledged_Shares_Percentage = Column(float)
    Difference_in_Major_Shareholder_Holdings_TSE_from_Previous_Period = Column(float)
    Employee_Subscription_Rate_Percentage = Column(float)
    Preferred_Stock_Shares_TTM = Column(float)
    Difference_in_Major_Shareholder_Relatives_Total_Holdings_1_Excluding_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Difference_in_Managers_Relatives_Total_Holdings_from_Previous_Period = Column(float)
    Total_CI_A = Column(float)
    Independent_Supervisors_Count = Column(float)
    Days_In_Position = Column(float)
    Top_10_Shareholder_Relatives_Holdings_Percentage_1_Excluding_Directors_and_Supervisors = Column(float)
    Convertible_Shares_Total_Thousand_Shares = Column(float)
    Difference_in_Directors_Total_Pledged_Shares_from_Previous_Period = Column(float)
    Directors_Pledged_Shares = Column(float)
    Difference_in_Managers_Total_Holdings_Percentage_from_Previous_Period = Column(float)
    Difference_in_Directors_Relatives_Total_Holdings_from_Previous_Period = Column(float)
    Total_Shares = Column(float)
    Days_Sales_Outstanding_Q = Column(float)
    Difference_in_Directors_Relatives_Holdings_Percentage_from_Previous_Period = Column(float)
    Director_Holdings_Percentage = Column(float)
    Manager_Holdings = Column(float)
    Managers_Pledged_Shares_Percentage_Including_Directors_and_Supervisors = Column(float)
    Purchase_Rate_Percentage = Column(float)
    ROA_A_Income_From_Continuing_Operation_Before_Interest_Q = Column(float)
    Vice_Chairman_Count = Column(float)
    Dividends_Distri_Year = Column(float)
    Finance_Costs_Net_A = Column(float)
    Difference_in_Top_10_Shareholder_Total_Pledged_Shares_Including_Rollover_from_Previous_Period = Column(float)
    NCI_TTM = Column(float)
    Cash_Dividend = Column(float)
    Top_10_Shareholder_Total_Pledge_Shares_2 = Column(float)
    Manager_Holdings_Percentage_Including_Directors_and_Supervisors = Column(float)
    Net_Service_Fee_Charge_Income_Losses_Banking_And_Financial_TTM = Column(float)
    Total_Revenue_Securities_Q = Column(float)
    Top_10_Shareholder_Holdings_Excluding_Directors_and_Supervisors = Column(float)
    Difference_in_Supervisors_Relatives_Holdings_Percentage_from_Previous_Period = Column(float)
    Total_Non_Current_Liabilities_A = Column(float)
    Difference_in_Major_Shareholder_Pledged_Shares_TSE_from_Previous_Period = Column(float)
    Total_Equity_Growth_Rate_YOY_TTM = Column(float)
    Difference_in_Top_10_Shareholder_Total_Holdings_Excluding_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Common_Stock_Shares_Q = Column(float)
    Supervisors_Pledged_Shares_Percentage = Column(float)
    Major_Shareholder_Pledged_Shares_TSE = Column(float)
    Managers_Total_Pledged_Shares_Percentage = Column(float)
    Major_Shareholder_Total_Pledged_Shares_Percentage_1 = Column(float)
    Total_Non_Current_Liabilities_Q = Column(float)
    Preferred_Stock_Shares_A = Column(float)
    Total_Director_Holdings_Percentage = Column(float)
    General_Supervisors_Count = Column(float)
    Difference_in_Director_Holdings_Percentage_from_Previous_Period = Column(float)
    Top_10_Shareholder_Total_Pledged_Including_Rollover = Column(float)
    Total_Equity_Growth_Rate_YOY_Q = Column(float)
    Employee_Bonus_Thousand_Shares = Column(float)
    Cash_Flow_Ratio_A = Column(float)
    GDR_Rate_Percentage = Column(float)
    Difference_in_Total_Director_Holdings_Percentage_from_Previous_Period = Column(float)
    Difference_in_Top_10_Shareholder_Relatives_Holdings_Percentage_2_Excluding_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Preferred_Shares_Securities_Conversion_Thousand_Shares = Column(float)
    Net_Income_Loss_Of_Interest_Banking_And_Financial__Q = Column(float)
    R_and_D_Expenses_Ratio_TTM = Column(float)
    Difference_in_Managers_Relatives_Pledged_Shares_Percentage_from_Previous_Period = Column(float)
    Top_10_Shareholder_Total_Pledged_Shares_Percentage_Including_Rollover = Column(float)
    Days_Inventory_On_Hand_Q = Column(float)
    Restricted_Employee_Rights_New_Stock_Cancellation_Thousand_Shares = Column(float)
    Difference_in_Directors_and_Supervisors_Pledged_Shares_Percentage_from_Previous_Period = Column(float)
    Difference_in_Directors_Relatives_Total_Pledged_Shares_from_Previous_Period = Column(float)
    Difference_in_Directors_and_Supervisors_Pledged_Shares_from_Previous_Period = Column(float)
    Net_Cash_Flows_From_Used_In_Operating_Activities_TTM = Column(float)
    Total_Director_Holdings = Column(float)
    Acid_Test_Ratio_Q = Column(float)
    Total_CI_Q = Column(float)
    Difference_in_Managers_Total_Pledged_Shares_Percentage_from_Previous_Period = Column(float)
    Difference_in_Top_10_Shareholder_Holdings_Excluding_Directors_and_Supervisors_from_Previous_Period = Column(float)
    Foreign_Supervisors_Count = Column(float)
    Basic_Earnings_Per_Share_MOPS_TTM = Column(float)
    Insufficient_Supervisor_Shares = Column(float)
    Total_Non_Operating_Income_And_Expenses_Insurance_TTM = Column(float)
    Buyback_Price_Range_Lower_Limit = Column(float)
    Ex_Rights_Reference_Price_Per_Unit = Column(float)
    Total_Treasury_Shares_A = Column(float)
    Difference_in_Supervisors_Total_Holdings_Percentage_from_Previous_Period = Column(float)
    Difference_in_Supervisor_Holdings_from_Previous_Period = Column(float)
    BV_Per_Share_A_Reserve_For_Capital_Increase_And_Preference_Shares_Adjusted_TTM = Column(float)
    Total_Operating_Revenue_TTM = Column(float)
    Public_Underwriting_Rate_Percentage = Column(float)
    Total_Non_Operating_Income_And_Expenses_TTM = Column(float)
    Common_Stock_Shares_A = Column(float)
    Supervisor_Holdings_Percentage = Column(float)
    Supervisors_Total_Pledged_Shares_Percentage = Column(float)
    Equivalent_Shares_Of_Stock_Dividend_To_Be_Distributed_A = Column(float)
    buyback_no = Column(float)
    Cash_Flow_Ratio_TTM = Column(float)
    Difference_in_Directors_and_Supervisors_Relatives_Total_Holdings_from_Previous_Period = Column(float)
    Weighted_Average_Number_Of_Ordinary_Shares_In_Thousands_A = Column(float)
    Total_Equity_Growth_Rate_YOY_A = Column(float)
    Total_Operating_Costs_TTM = Column(float)
    Supervisors_Relatives_Pledged_Shares_Percentage_Percentage = Column(float)




    extra_dims = [
        ('frequency', {'MRQ', 'MRA', 'Daily'}),
        ('period_offset', set(range(-127,1))),
    ]
    
    @classmethod
    def slice(
        cls,
        frequency: Literal['MRQ','MRA', 'Daily'],
        period_offset: int = 0
    ) :


        return super().slice(frequency=frequency, period_offset=period_offset)

TQDataSet = TQData.slice(frequency='Daily', period_offset=0)

class TQAltData(DataSetFamily):
    domain = TW_EQUITIES
    # Daily Trading Info
    Dividend_Yield_TWSE = Column(float)
    Cash_Dividend_Yield_TEJ = Column(float)
    Adjust_Factor = Column(float)
    Transaction = Column(float)
    Issue_Shares_1000_Shares = Column(float)
    PBR_TEJ = Column(float)
    Low = Column(float)
    PER_TWSE = Column(float)
    Adjust_Factor_Exclude_CashDiv = Column(float)
    Close = Column(float)
    Market_Cap_Percentage = Column(float)
    Open = Column(float)
    PBR_TWSE = Column(float)
    Last_Bid = Column(float)
    Value_Dollars = Column(float)
    High_Low_Diff = Column(float)
    Average_Trade_Price = Column(float)
    Trade_Value_Percentage = Column(float)
    High = Column(float)
    ROI = Column(float)
    Turnover = Column(float)
    PER_TEJ = Column(float)
    Last_Offer = Column(float)
    PSR_TEJ = Column(float)
    Market_Cap_Dollars = Column(float)
    Volume_1000_Shares = Column(float)
    # Trading Annotation
    Component_Stock_of_High_Dividend_Fg = Column(object)
    Matching_Period = Column(float)
    Industry = Column(object)
    Industry_Eng = Column(object)
    Sub_Industry = Column(object)  # 20231108
    Sub_Industry_Eng = Column(object) # 20231108
    Security_Type_English = Column(object)
    Component_Stock_of_MSCI_TW_Fg = Column(object)
    Suspended_Trading_Stock_Fg = Column(object)
    Attention_Stock_Fg = Column(object)
    Component_Stock_of_MidCap100_Fg = Column(object)
    Limit_Up_or_Down_in_Opening_Fg = Column(object)
    Market_Board = Column(object)
    Market_Board_Eng = Column(object)
    Security_Type_Chinese = Column(object)
    Suspension_of_Buy_After_Day_Trading_Fg = Column(object)
    Suspension_of_Sell_After_Day_Trading_Fg = Column(object)
    Limit_Up_or_Down = Column(object)
    Component_Stock_of_TPEx200_Fg = Column(object)
    Disposition_Stock_Fg = Column(object)
    Full_Delivery_Stock_Fg = Column(object)
    Component_Stock_of_TPEx50_Fg = Column(object)
    Component_Stock_of_TWN50_Fg = Column(object)

    # Institutional Shares Data
    Dealer_Hedge_Diff_Amt = Column(float)
    Total_Sell_Amt = Column(float)
    Margin_Day_Trading_Amt = Column(float)
    Total_Buy_Vol = Column(float)
    Fund_Sell_Vol = Column(float)
    Fund_Stock_Holding_Pct = Column(float)
    Dealer_Proprietary_Diff_Vol = Column(float)
    Dealer_Proprietary_Sell_Vol = Column(float)
    Margin_Short_Balance_Vol = Column(float)
    Margin_Short_Maintenance_Ratio = Column(float)
    SBL_Short_Returns_Vol = Column(float)
    Fund_Buy_Vol = Column(float)
    SBL_Short_Balance_Amt = Column(float)
    Fund_Diff_Amt = Column(float)
    SBL_Short_Sales_Vol = Column(float)
    Qfii_Stock_Holding_Pct = Column(float)
    Fund_Diff_Vol = Column(float)
    Cash_Redemption = Column(float)
    Dealer_Hedge_Diff_Vol = Column(float)
    Dealer_Stock_Holding_Pct = Column(float)
    SBL_Short_Balance_Vol = Column(float)
    Fund_Sell_Amt = Column(float)
    Margin_Purchase = Column(float)
    Qfii_Diff_Vol = Column(float)
    Total_Buy_Amt = Column(float)
    Margin_Short_Balance_Amt = Column(float)
    Margin_Short_Sales = Column(float)
    Margin_Short_Quota = Column(float)
    SBL_Short_Quota = Column(float)
    Fund_Buy_Amt = Column(float)
    Margin_Day_Trading_Vol = Column(float)
    Total_Diff_Amt = Column(float)
    Total_Sell_Vol = Column(float)
    Dealer_Hedge_Buy_Vol = Column(float)
    Qfii_Sell_Amt = Column(float)
    Dealer_Hedge_Sell_Amt = Column(float)
    SBL_Short_Sales_Amt = Column(float)
    Dealer_Proprietary_Diff_Amt = Column(float)
    Margin_Maintenance_Ratio = Column(float)
    Qfii_Buy_Vol = Column(float)
    Dealer_Proprietary_Sell_Amt = Column(float)
    Dealer_Hedge_Buy_Amt = Column(float)
    Margin_Short_Coverting = Column(float)
    Day_Trading_Volume_1000_Shares = Column(float)
    Dealer_Proprietary_Buy_Amt = Column(float)
    Margin_Balance_Amt = Column(float)
    Qfii_Buy_Amt = Column(float)
    Qfii_Sell_Vol = Column(float)
    Margin_Stock_Redemtion = Column(float)
    Qfii_Diff_Amt = Column(float)
    Account_Maintenance_Ratio = Column(float)
    Margin_Quota = Column(float)
    Margin_Balance_Vol = Column(float)
    Margin_Balance_Ratio = Column(float)
    Total_Diff_Vol = Column(float)
    Day_Trading_Pct = Column(float)
    Margin_Sale = Column(float)
    Dealer_Proprietary_Buy_Vol = Column(float)
    Dealer_Hedge_Sell_Vol = Column(float)

    # Week Share Distribution
    Custodied_Lots_Between_400_600_Pct = Column(float)
    Custodied_Larger_Than_400_Lots_Total_Lots = Column(float)
    Custodied_Greater_Than_1000_Lots_Total_Lots = Column(float)
    Custodied_Lots_Between_800_1000_Total_Holders = Column(float)
    Custodied_Lots_Between_600_800_Total_Holders = Column(float)
    Pledged_Stock_Shares_1000_Lots = Column(float)
    Custodied_Greater_Than_1000_Lots_Pct = Column(float)
    Custodied_Lots_Between_600_800_Pct = Column(float)
    Custodied_Lots_Between_800_1000_Total_Lots = Column(float)
    Total_Custodied_Shares_1000_Lots = Column(float)
    Custodied_Larger_Than_400_Lots_Total_Holders = Column(float)
    Custodied_Larger_Than_400_Lots_Pct = Column(float)
    Custodied_Under_400_Lots_Pct = Column(float)
    Custodied_Greater_Than_1000_Lots_Total_Holders = Column(float)
    Custodied_Under_400_Lots_Total_Holders = Column(float)
    Custodied_Lots_Between_800_1000_Pct = Column(float)
    Custodied_Lots_Between_600_800_Total_Lots = Column(float)
    Custodied_Under_400_Lots_Total_Lots = Column(float)
    Custodied_Lots_Between_400_600_Total_Lots = Column(float)
    Custodied_Lots_Between_400_600_Total_Holders = Column(float)

    # Monthly Sales Data
    Sales_Accu_LastYear = Column(float)
    Outstanding_Shares_1000_Shares = Column(float)
    MoM_Monthly_Sales = Column(float)
    Sales_Per_Share_Accu = Column(float)
    Month_Sales_Compared_To_Lowest_Month_Sales_MoM = Column(float)
    YoY_Accu_Sales_3M = Column(float)
    Lowest_Monthly_Sales_YM = Column('datetime64[ns]')
    YoY_AccuSales_12M = Column(float)
    Sales_Monthly = Column(float)
    MoM_Accu_Sales_3M = Column(float)
    Sales_Per_Share_Single_Month = Column(float)
    Highest_Or_Lowest_In_12M = Column(object)
    Hit_New_High_Or_Low_In_N_Months = Column(float)
    Sales_Per_Share_Accu_3M = Column(float)
    Sales_Accu_3M = Column(float)
    Highest_Or_Lowest_Same_Month = Column(object)
    Highest_Monthly_Sales_YM = Column('datetime64[ns]')
    Month_Sales_Compared_To_High_Month_Sales_MoM = Column(float)
    Lowest_Monthly_Sales = Column(float)
    Highest_Monthly_Sales = Column(float)
    Sales_Accu_3M_LastYear = Column(float)
    Sales_Accumulated = Column(float)
    YoY_Accu_Sales = Column(float)
    Sales_Accu_12M_Last_Year = Column(float)
    Sales_Accu_12M = Column(float)
    Sales_Per_Share_Accu_12M = Column(float)
    Highest_Or_Lowest_All_Time = Column(object)
    YoY_Monthly_Sales = Column(float)
    QoQ_Accu_Sales_3M = Column(float)
    Sales_Monthly_LastYear = Column(float)

    # 董監持股
    Director_and_Supervisor_Holdings_Percentage = Column(float)
    Manager_Holdings_Percentage = Column(float)
    Major_Shareholder_Holdings_Percentage_TSE = Column(float)
    Total_Director_and_Supervisor_Holdings_Percentage = Column(float)
    Managers_Total_Holdings_Percentage = Column(float)
    Major_Shareholder_Total_Holdings_Percentage_TSE = Column(float)

    mon_sales_date = Column('datetime64[ns]')
    share_date = Column('datetime64[ns]')

    extra_dims = [
        ('period_offset', set(range(-127,1))),
    ]

    @classmethod
    def slice(
        cls,
        period_offset: int = 0
    )->'TQAltData':


        return super().slice(period_offset=period_offset)

TQAltDataSet = TQAltData.slice(period_offset=0)
